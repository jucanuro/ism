/home/jucanuro/projects/ism/reportes/data_manager.py:231: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-05-29

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-05-29...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-05-29)...
ðŸ’¥ OcurriÃ³ un error en la consulta de Ventas Arica: ('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]TCP Provider: Error code 0x274C (10060) (SQLGetData)')
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-05-29)...
ðŸ’¥ OcurriÃ³ un error en la consulta de Ventas Iquique: Execution failed on sql: 
    SELECT 
        'CHILE' AS PAIS, 'IQUIQUE' AS CIUDAD, DAY(CDT.FECHA) AS DIA, 
        CASE WHEN MONTH(CDT.FECHA) = 1 THEN 'ENERO' WHEN MONTH(CDT.FECHA) = 2 THEN 'FEBRERO' WHEN MONTH(CDT.FECHA) = 3 THEN 'MARZO' WHEN MONTH(CDT.FECHA) = 4 THEN 'ABRIL' WHEN MONTH(CDT.FECHA) = 5 THEN 'MAYO' WHEN MONTH(CDT.FECHA) = 6 THEN 'JUNIO' WHEN MONTH(CDT.FECHA) = 7 THEN 'JULIO' WHEN MONTH(CDT.FECHA) = 8 THEN 'AGOSTO' WHEN MONTH(CDT.FECHA) = 9 THEN 'SEPTIEMBRE' WHEN MONTH(CDT.FECHA) = 10 THEN 'OCTUBRE' WHEN MONTH(CDT.FECHA) = 11 THEN 'NOVIEMBRE' WHEN MONTH(CDT.FECHA) = 12 THEN 'DICIEMBRE' END AS MES, 
        YEAR(CDT.FECHA) AS AÃ‘O, CDT.[ESTADO DOCUMENTO] AS ESTADO, CDT.[NUMERO DE DOCUMENTO] AS FACTURA, 
        'VENTAS' AS TIPO, 'ENTREGADO' AS MOTIVO, CLD.cod_cliente AS codigo_cliente, C.NOMBRE AS CLIENTE,
        CLD.ITEM AS SUCURSAL, CONCAT(CDT.CODCLIENTE, CLD.item) AS CODIGO_SUCURSAL, C.RUT, CLD.ruta, G.NOMBRE AS GIRO,
        CLD.DIRECCION, V.NOMBRE AS VENDEDOR, D.NOMBRE AS DISTRIBUIDOR, PS.CATEGORIA, PS.MARCA, PS.FORMATO,
        PS.SABOR,
        SUM(DDT.CANTIDAD * CASE WHEN CDT.[LISTA PRECIO] = 1 AND DDT.descuento = 0 THEN PD.[CDIST MIN] WHEN CDT.[LISTA PRECIO] = 1 AND DDT.descuento > 0 THEN PD.[CDIST MAY] WHEN CDT.[LISTA PRECIO] = 2 AND DDT.descuento = 0 THEN PD.[CDIST MIN PROV] WHEN CDT.[LISTA PRECIO] = 2 AND DDT.descuento > 0 THEN PD.[CDIST MAY PROV] ELSE 0 END) AS COM_DISTRIBUIDOR,
        SUM(DDT.CANTIDAD * CASE WHEN CDT.[LISTA PRECIO] = 1 AND DDT.descuento = 0 THEN PD.[CVEND MIN] WHEN CDT.[LISTA PRECIO] = 1 AND DDT.descuento > 0 THEN PD.[CVEND MAY] WHEN CDT.[LISTA PRECIO] = 2 AND DDT.descuento = 0 THEN PD.[CVEND MIN PROV] WHEN CDT.[LISTA PRECIO] = 2 AND DDT.descuento > 0 THEN PD.[CVEND MAY PROV] ELSE 0 END) AS COM_VENDEDOR,
        SUM(DDT.CANTIDAD) AS DISPLAY, SUM(PD.MCUBICO * DDT.CANTIDAD * PD.CXBULTO) AS LITROS,
        SUM(DDT.neto) AS NETO, SUM(DDT.arancel) AS ARANCEL, SUM(DDT.ila13) AS ILA13,
        SUM(DDT.bruto) AS BRUTO, SUM(DDT.CANTIDAD * DDT.[PRECIO LISTA UNITARIO]) AS MONTO
    FROM TiendaKR.dbo.CABECERADOCUMENTO CDT 
    INNER JOIN TiendaKR.dbo.DETALLEDOCUMENTO as DDT ON CDT.[NUMERO DE DOCUMENTO]=DDT.[NUMERO DE DOCUMENTO] 
    INNER JOIN TiendaKR.dbo.CLIENTES AS C ON CDT.CODCLIENTE=C.[CODIGO NUMERICO]
    INNER JOIN TiendaKR.dbo.CLIENTES_DIR AS CLD ON C.[CODIGO NUMERICO] = CLD.cod_cliente AND CDT.[DIR CLIENTE] = cld.item
    INNER JOIN TiendaKR.dbo.VENDEDOR AS V ON CDT.[CODIGO VENDEDOR] = V.CODIGO 
    INNER JOIN TiendaKR.dbo.DISTRIBUIDOR AS D ON CDT.DISTRIBUIDOR = D.CODIGO 
    INNER JOIN ZoftNetSVE.dbo.PRODUCTOSAP AS PS ON DDT.ESPECIFICO = PS.[CODIGO CHILE] 
    INNER JOIN TiendaKR.dbo.PRODUCTO AS PD ON DDT.ESPECIFICO=PD.ESPECIFICO 
    INNER JOIN TiendaKR.dbo.GIRO AS G ON C.GIRO=G.CODIGO 
    WHERE CDT.[TIPO DE DOCUMENTO] ='FA' AND CDT.[ESTADO DOCUMENTO] IN('I','C') AND CDT.FECHA BETWEEN ? AND ?
    GROUP BY cdt.[ESTADO DOCUMENTO], cdt.[NUMERO DE DOCUMENTO],CDT.FECHA,CLD.cod_cliente,C.NOMBRE,CLD.item, CLD.DIRECCION,V.NOMBRE,D.NOMBRE,PS.MARCA, PS.CATEGORIA, PS.FORMATO, PS.SABOR, PD.MCUBICO, PD.CXBULTO, CDT.[LISTA PRECIO], PD.[CDIST MIN], PD.[CDIST MAY], PD.[CDIST MIN PROV], PD.[CDIST MAY PROV], PD.[CVEND MIN], PD.[CVEND MAY], PD.[CVEND MIN PROV], PD.[CVEND MAY PROV], DDT.[PRECIO LISTA UNITARIO], C.RUT, CLD.ruta, G.NOMBRE, DDT.descuento, CDT.CODCLIENTE;

('08S01', '[08S01] [Microsoft][ODBC Driver 18 for SQL Server]Communication link failure (0) (SQLExecDirectW)')
unable to rollback
No se encontraron datos de ventas para unir.
ConexiÃ³n (fetch_dashboard_data) cerrada.
No se obtuvieron datos para DatosDashboard (Ventas). No se actualizÃ³ la tabla.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-05-29...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-05-29)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 9553 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-05-29)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 7738 filas.
Total de filas de Rechazos consolidadas para el rango: 17291
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 17291 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 17291 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 17291 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-01

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-01...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-01)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 113689 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-01)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 154582 filas.
Total de filas de Ventas consolidadas para el rango: 268271
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 268271 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 268271 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 268271 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-01...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-01)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 9682 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-01)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 7940 filas.
Total de filas de Rechazos consolidadas para el rango: 17622
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 17622 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 17622 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 17622 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
Traceback (most recent call last):
  File "/home/jucanuro/projects/ism/manage.py", line 22, in <module>
    main()
  File "/home/jucanuro/projects/ism/manage.py", line 18, in main
    execute_from_command_line(sys.argv)
  File "/home/jucanuro/projects/ism/venv/lib/python3.9/site-packages/django/core/management/__init__.py", line 442, in execute_from_command_line
    utility.execute()
  File "/home/jucanuro/projects/ism/venv/lib/python3.9/site-packages/django/core/management/__init__.py", line 382, in execute
    settings.INSTALLED_APPS
  File "/home/jucanuro/projects/ism/venv/lib/python3.9/site-packages/django/conf/__init__.py", line 102, in __getattr__
    self._setup(name)
  File "/home/jucanuro/projects/ism/venv/lib/python3.9/site-packages/django/conf/__init__.py", line 89, in _setup
    self._wrapped = Settings(settings_module)
  File "/home/jucanuro/projects/ism/venv/lib/python3.9/site-packages/django/conf/__init__.py", line 217, in __init__
    mod = importlib.import_module(self.SETTINGS_MODULE)
  File "/home/jucanuro/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/jucanuro/projects/ism/ism_dashboard/settings.py", line 21, in <module>
    load_dotenv(dotenv_path=dotenv_path)
NameError: name 'dotenv_path' is not defined
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-04

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-04...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-04)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 116972 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-04)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 158085 filas.
Total de filas de Ventas consolidadas para el rango: 275057
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 275057 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 275057 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 275057 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-04...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-04)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 9779 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-04)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8014 filas.
Total de filas de Rechazos consolidadas para el rango: 17793
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 17793 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 17793 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 17793 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-05

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-05...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-05)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 117623 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-05)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 159344 filas.
Total de filas de Ventas consolidadas para el rango: 276967
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 276967 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 276967 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 276967 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-05...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-05)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 9901 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-05)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8043 filas.
Total de filas de Rechazos consolidadas para el rango: 17944
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 17944 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 17944 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 17944 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-07

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-07...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-07)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 118569 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-07)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 161623 filas.
Total de filas de Ventas consolidadas para el rango: 280192
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 280192 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 280192 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 280192 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-07...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-07)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 9974 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-07)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8130 filas.
Total de filas de Rechazos consolidadas para el rango: 18104
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 18104 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 18104 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 18104 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-10

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-10...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-10)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 120043 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-10)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 163773 filas.
Total de filas de Ventas consolidadas para el rango: 283816
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 283816 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 283816 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 283816 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-10...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-10)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 10030 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-10)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8220 filas.
Total de filas de Rechazos consolidadas para el rango: 18250
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 18250 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 18250 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 18250 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-13

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-13...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-13)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 122528 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-13)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 167143 filas.
Total de filas de Ventas consolidadas para el rango: 289671
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 289671 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 289671 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 289671 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-13...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-13)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 10192 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-13)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8357 filas.
Total de filas de Rechazos consolidadas para el rango: 18549
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 18549 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 18549 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 18549 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-14

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-14...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-14)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 123335 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-14)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 168242 filas.
Total de filas de Ventas consolidadas para el rango: 291577
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 291577 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 291577 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 291577 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-14...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-14)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 10229 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-14)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8374 filas.
Total de filas de Rechazos consolidadas para el rango: 18603
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 18603 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 18603 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 18603 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-18

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-18...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-18)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 126022 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-18)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 171638 filas.
Total de filas de Ventas consolidadas para el rango: 297660
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 297660 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 297660 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 297660 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-18...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-18)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 10430 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-18)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8515 filas.
Total de filas de Rechazos consolidadas para el rango: 18945
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 18945 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 18945 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 18945 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
/home/jucanuro/projects/ism/reportes/data_manager.py:142: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df = pd.read_sql(consulta_sql, conexion, params=[fecha_inicio, fecha_fin])
--- Iniciando actualizaciÃ³n de datos ---
Rango de carga: 2025-01-01 a 2025-06-19

Obteniendo datos de Ventas DESDE 2025-01-01 HASTA 2025-06-19...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Ventas Arica (Rango: 2025-01-01 a 2025-06-19)...
âœ… Â¡Consulta de Ventas Arica exitosa! Se encontraron 126805 filas.
 Ejecutando consulta para Ventas Iquique (Rango: 2025-01-01 a 2025-06-19)...
âœ… Â¡Consulta de Ventas Iquique exitosa! Se encontraron 172915 filas.
Total de filas de Ventas consolidadas para el rango: 299720
ConexiÃ³n (fetch_dashboard_data) cerrada.
Se obtuvieron 299720 filas para DatosDashboard (Ventas).
Limpiando tabla DatosDashboard (Ventas)...
Tabla DatosDashboard (Ventas) limpiada.
Preparando 299720 objetos de DatosDashboard (Ventas) para guardar...
Â¡ActualizaciÃ³n de DatosDashboard (Ventas) completada! Se guardaron 299720 registros.

Obteniendo datos de Rechazos DESDE 2025-01-01 HASTA 2025-06-19...
[INFO] Conectando a Servidor 2 / TiendaKR...
 Ejecutando consulta para Rechazos Arica (Rango: 2025-01-01 a 2025-06-19)...
âœ… Â¡Consulta de Rechazos Arica exitosa! Se encontraron 10503 filas.
 Ejecutando consulta para Rechazos Iquique (Rango: 2025-01-01 a 2025-06-19)...
âœ… Â¡Consulta de Rechazos Iquique exitosa! Se encontraron 8606 filas.
Total de filas de Rechazos consolidadas para el rango: 19109
ConexiÃ³n (fetch_rechazos_data) cerrada.
Se obtuvieron 19109 filas para DatosRechazos.
Limpiando tabla DatosRechazos...
Tabla DatosRechazos limpiada.
Preparando 19109 objetos de DatosRechazos para guardar...
Â¡ActualizaciÃ³n de DatosRechazos completada! Se guardaron 19109 registros.
--- Proceso de actualizaciÃ³n finalizado. ---
